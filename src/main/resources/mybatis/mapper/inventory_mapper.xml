<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.digital.v3.sql.mapper.InventoryMapper">
	
	<insert id="createInventory" parameterType="InventoryVO">
	    INSERT INTO inventory (productid, quantity, createdate, updatedate)
	    VALUES (#{productId}, #{quantity}, SYSDATE, SYSDATE)
	</insert>
	
	<select id="isExistInventory" parameterType="long" resultType="int">
		SELECT NVL(COUNT(productid), 0)
		FROM inventory
		WHERE productid = #{productId}
	</select>
	
	<select id="getInventoryByProduct" parameterType="long" resultType="InventoryVO">
		SELECT i.productid, i.quantity
		FROM inventory i
			JOIN product p ON p.productid = i.productid
		WHERE p.productname = #{productName}
	</select>
	
	<update id="updateInventoryQuantity" parameterType="InventoryVO">
		UPDATE inventory
		SET quantity = #{quantity}, updatedate = SYSDATE
		WHERE productid = #{productId}
	</update>
	
</mapper>